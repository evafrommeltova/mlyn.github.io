<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js vr - lorenz attractor</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
		<link type="text/css" rel="stylesheet" href="main.css">
	</head>
		<script src="js/three.js"></script>
		<script src="js/ColladaLoader2.js"></script>
		<script src="js/OrbitControls.js"></script>
		<script src="js/Detector.js"></script>
		<script src="js/VRButton.js"></script>
	<body>
		<script type="module">

			import * as THREE from './js/three.module.js';
			import { VRButton } from './js/VRButton.js';
			import { ColladaLoader } from './js/ColladaLoader2.js';
			import { OrbitControls} from './js/OrbitControls.js';
			import {Detector} from './js/Detector.js';

			let camera, scene, renderer;
			let attractor, light;
			

			init();
			animate();


			function init() {

				scene = new THREE.Scene();

				camera = new THREE.PerspectiveCamera( 50, window.innerWidth / window.innerHeight, 0.1, 10 );
				camera.position.set( 0, 1.6, 1 );


				var ambientLight = new THREE.AmbientLight( 0xffffff, 0.2 );
				scene.add( ambientLight );

				var directionalLight = new THREE.DirectionalLight( 0xffffff, 0.8 );
				directionalLight.position.set( 1, 1, 1 ).normalize();
				camera.add( directionalLight );
                //        camera.add( directionalLight.target );

				var loader = new THREE.ColladaLoader();
				loader.options.convertUpAxis = true;
				loader.load('./dae/krytiny.dae', function ( collada ) {
					var animations = collada.animations;
					var avatar = collada.scene;
					scene.add( avatar );
				} );

				//

				renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.xr.enabled = true;
				document.body.appendChild( renderer.domElement );

				document.body.appendChild( VRButton.createButton( renderer ) );

				//

				window.addEventListener( 'resize', onWindowResize );

				//

				

			}

			function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}

			function animate() {

				renderer.setAnimationLoop( render );

			}

			function render() {

				//for ( let i = 0; i < speed; i ++ ) draw();

				//attractor.geometry.attributes.position.needsUpdate = true;
				//attractor.geometry.attributes.color.needsUpdate = true;
				//ttractor.rotation.z += .001;

				renderer.render( scene, camera );

			}

		</script>
	</body>
</html>